## Mettre en place un "Circuit breaker"

### Identifiants

| GreenIT | V2  | V3  | V4  |
|:-------:|:---:|:---:|:---:|
|         |     |     |     |

RGESN: 2.10

### Catégories

| Cycle de vie  |   Tiers    |           Responsable           |
|:-------------:|:----------:|:-------------------------------:|
| 2. Conception | Datacenter | Architecte Logiciel/Développeur |

### Indications

| Degré de priorité | Mise en oeuvre | Impact écologique |
|:-----------------:|:--------------:|:-----------------:|
|         2         |       2        |         2         |

|Ressources Economisées                                      |
|:-----------------------------------------------------:|
|            Processeur / Réseau / Requêtes             |

### Description

Un circuit breaker est un patron de conception (design pattern) permettant d’optimiser les appels à un service (typiquement une API) dans le cas où celui-ci est en erreur.

En fonction d’un certain nombre de critères d’erreur (timeout, nombre d’erreurs), le service appelant détecte le problème et, au lieu d’appeler le service de façon indifférenciée, peut remplacer l’appel par un comportement prédéfini comme l’utilisation d’une valeur par défaut ou l’appel d’un autre service. Dans tous les cas, le circuit breaker permet de définir une politique pour re-tenter d’appeler le service défaillant : réessayer toutes les x secondes par exemple.

Cette pratique permet d’économiser des ressources (appels réseaux) aussi bien au niveau de l’appelant (inutile d’appeler un service qui échoue), que de l’appelé, qui peut alors plus facilement se rétablir.


### Exemple

Sur un site e-commerce les informations détaillées d'une fiche produit peuvent être fournies par un service dédié. 
Le service principal qui récupère une page produit a "appris" que le service des informations détaillées était en erreur, il évite alors
de l'appeler inutilement tant qu'il ne répond pas favorablement et ne renvoie donc pas cette information à l'utilisateur final.
Le service reste opérationnel bien que l'expérience soit dégradée.

### Principe de validation

| Le nombre ...                                                        | est inférieur ou égal à |
|----------------------------------------------------------------------|:-----------------------:|
| de "circuit breakers" non mis en place sur des services externes |            0            |
